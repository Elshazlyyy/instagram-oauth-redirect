<!DOCTYPE html>
<html>
<head>
  <title>Redirecting...</title>
  <script type="text/javascript">
    function getQueryParams(url) {
      const params = {};
      const parser = document.createElement('a');
      parser.href = url;
      const query = parser.search.substring(1);
      const vars = query.split('&');
      for (let i = 0; i < vars.length; i++) {
        const pair = vars[i].split('=');
        params[pair[0]] = decodeURIComponent(pair[1]);
      }
      return params;
    }

    window.onload = function() {
      console.log('Page loaded. Current URL:', window.location.href);
      const params = getQueryParams(window.location.href);
      console.log('Query parameters:', params);

      if (params['code']) {
        const redirectUri = `soiree://auth?code=${encodeURIComponent(params['code'])}`;
        console.log('Redirect URI:', redirectUri);

        const redirectP = document.createElement('p');
        redirectP.textContent = `Redirect URI: ${redirectUri}`;
        document.body.appendChild(redirectP);

        setTimeout(() => {
          window.location.replace(redirectUri);
        }, 3000); // Delay redirect by 3 seconds to view parameters
      } else {
        console.error('Authorization code not found in query parameters.');
      }
    };
  </script>
</head>
<body>
  <p>Redirecting...</p>
</body>
</html>
